<Window x:Class="ThumbPick.Gui.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ThumbPick.Gui"
        mc:Ignorable="d"
        Title="ThumbPick"
        Icon="..\..\icon.ico"
        Height="600"
        Width="900"
        MinWidth="700"
        MinHeight="500"
        AllowDrop="True"
        DragEnter="Window_DragEnter"
        Drop="Window_Drop">
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Border x:Name="DropZone"
                Grid.Row="0"
                Background="#1F4B73"
                BorderBrush="#2E6FA6"
                BorderThickness="1.5"
                CornerRadius="8"
                Padding="24"
                AllowDrop="True"
                DragEnter="DropZone_DragEnter"
                Drop="DropZone_Drop">
            <StackPanel HorizontalAlignment="Center">
                <TextBlock Text="Drag a video file here"
                           FontSize="18"
                           FontWeight="SemiBold"
                           Foreground="White"
                           HorizontalAlignment="Center" />
                <TextBlock Text="or use the controls below to choose inputs"
                           Margin="0,8,0,0"
                           Foreground="White"
                           HorizontalAlignment="Center" />
            </StackPanel>
        </Border>

        <Grid Grid.Row="1" Margin="0,16,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="Video file"
                       VerticalAlignment="Center"
                       Margin="0,0,12,0" />
            <TextBox x:Name="VideoPathTextBox"
                     Grid.Column="1"
                     Margin="0,0,12,0"
                     VerticalAlignment="Center"
                     AllowDrop="False" />
            <Button Grid.Column="2"
                    Content="Browse..."
                    Width="100"
                    Click="BrowseVideo_Click" />
        </Grid>

        <Grid Grid.Row="2" Margin="0,12,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="Output folder"
                       VerticalAlignment="Center"
                       Margin="0,0,12,0" />
            <TextBox x:Name="OutputDirectoryTextBox"
                     Grid.Column="1"
                     Margin="0,0,12,0"
                     VerticalAlignment="Center" />
            <Button Grid.Column="2"
                    Content="Browse..."
                    Width="100"
                    Click="BrowseOutput_Click" />
        </Grid>

        <Grid Grid.Row="3" Margin="0,12,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="FFmpeg path"
                       VerticalAlignment="Center"
                       Margin="0,0,12,0" />
            <TextBox x:Name="FfmpegPathTextBox"
                     Grid.Column="1"
                     Margin="0,0,12,0"
                     VerticalAlignment="Center" />
            <Button Grid.Column="2"
                    Content="Browse..."
                    Width="100"
                    Click="BrowseFfmpeg_Click" />
        </Grid>

        <Border Grid.Row="4"
                Margin="0,16,0,0"
                Padding="16"
                BorderBrush="#DDD"
                BorderThickness="1"
                CornerRadius="6">
            <WrapPanel ItemWidth="220" MinWidth="200">
                <StackPanel Width="220" Margin="0,0,12,12">
                    <TextBlock Text="Preset"
                               FontWeight="SemiBold"
                               Margin="0,0,0,4" />
                    <ComboBox x:Name="PresetComboBox"
                              DisplayMemberPath="Name" SelectedValuePath="Key"
                              SelectedIndex="0" />
                </StackPanel>
                <StackPanel Width="220" Margin="0,0,12,12">
                    <TextBlock Text="Face Detection"
                               FontWeight="SemiBold"
                               Margin="0,0,0,4" />
                    <ComboBox x:Name="FaceDetectorComboBox"
                              SelectedIndex="0" />
                </StackPanel>
                <StackPanel Width="220" Margin="0,0,12,12">
                    <TextBlock Text="Sampling mode"
                               FontWeight="SemiBold"
                               Margin="0,0,0,4" />
                    <ComboBox x:Name="SamplingModeCombo"
                              SelectedIndex="0">
                        <ComboBoxItem Content="Frames per second" Tag="fps" />
                        <ComboBoxItem Content="Frames per minute" Tag="fpm" />
                    </ComboBox>
                </StackPanel>
                <StackPanel Width="220" Margin="0,0,12,12">
                    <TextBlock Text="Sampling value"
                               FontWeight="SemiBold"
                               Margin="0,0,0,4" />
                    <TextBox x:Name="SamplingValueTextBox" Text="2" />
                </StackPanel>
                <StackPanel Width="220" Margin="0,0,12,12">
                    <TextBlock Text="Top picks"
                               FontWeight="SemiBold"
                               Margin="0,0,0,4" />
                    <TextBox x:Name="TopCountTextBox" Text="6" />
                </StackPanel>
                <StackPanel Width="220" Margin="0,0,12,12">
                    <TextBlock Text="Neighbor count"
                               FontWeight="SemiBold"
                               Margin="0,0,0,4" />
                    <TextBox x:Name="NeighborCountTextBox" Text="2" />
                </StackPanel>
            </WrapPanel>
        </Border>

        <Border Grid.Row="5"
                Margin="0,16,0,0"
                Padding="16"
                BorderBrush="#DDD"
                BorderThickness="1"
                CornerRadius="6">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0"
                            Orientation="Horizontal"
                            VerticalAlignment="Center"
                            Margin="0,0,0,12">
                    <TextBlock Text="Preview"
                               FontSize="16"
                               FontWeight="SemiBold" />
                    <TextBlock Text="Mark thumbnails as Good or Bad and download the good ones."
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"
                               Foreground="#666" />
                </StackPanel>
                <ScrollViewer Grid.Row="1"
                              HorizontalScrollBarVisibility="Disabled"
                              VerticalScrollBarVisibility="Auto">
                    <ListView x:Name="ThumbnailListView"
                              BorderThickness="0"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Border Width="220"
                                        Margin="0,0,12,12"
                                        Padding="8"
                                        BorderBrush="#CCC"
                                        BorderThickness="1"
                                        CornerRadius="6">
                                    <StackPanel>
                                        <Image Source="{Binding Thumbnail}"
                                               Width="200"
                                               Height="112"
                                               Stretch="UniformToFill" />
                                        <TextBlock Text="{Binding DisplayName}"
                                                   Margin="0,8,0,0"
                                                   TextAlignment="Center"
                                                   TextWrapping="Wrap" />
                                        <TextBlock Text="{Binding ScoreText}"
                                                   FontSize="10"
                                                   Foreground="#666"
                                                   TextAlignment="Center" />
                                        <ComboBox SelectedValue="{Binding Selection, Mode=TwoWay}"
                                                  SelectedValuePath="Tag"
                                                  Margin="0,8,0,0">
                                            <ComboBoxItem Content="Undecided"
                                                          Tag="{x:Static local:ThumbnailSelectionState.Undecided}" />
                                            <ComboBoxItem Content="Good"
                                                          Tag="{x:Static local:ThumbnailSelectionState.Good}" />
                                            <ComboBoxItem Content="Bad"
                                                          Tag="{x:Static local:ThumbnailSelectionState.Bad}" />
                                        </ComboBox>
                                        <Button Content="Open"
                                                Margin="0,8,0,0"
                                                CommandParameter="{Binding}"
                                                Click="OpenThumbnail_Click" />
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </ScrollViewer>
            </Grid>
        </Border>

        <Grid Grid.Row="6" Margin="0,16,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0">
                <TextBlock x:Name="StatusTextBlock"
                           Text="Ready." />
                <TextBlock x:Name="ProgressDetailTextBlock"
                           Margin="0,4,0,0"
                           Foreground="#666"
                           FontSize="11" />
                <ProgressBar x:Name="ProcessingProgressBar"
                             Margin="0,8,16,0"
                             Height="8"
                             Minimum="0"
                             Maximum="1"
                             Visibility="Collapsed" />
            </StackPanel>
            <Button x:Name="DownloadButton"
                    Grid.Column="1"
                    Content="Download Selected"
                    Width="160"
                    Height="36"
                    Margin="0,0,16,0"
                    IsEnabled="False"
                    Click="DownloadSelected_Click" />
            <Button x:Name="RunButton"
                    Grid.Column="2"
                    Content="Run"
                    Width="120"
                    Height="36"
                    Click="RunButton_Click" />
        </Grid>
    </Grid>
</Window>
